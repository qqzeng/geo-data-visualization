<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=SGZAQcGREz9ugRxt9eWnn7nHynec9lRb"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"></script>
    <title>热力图功能展示</title>
    <style type="text/css">
        ul,li{list-style: none;margin:0;padding:0;float:left;}
        html{height:100%}
        body{height:100%;margin:0px;padding:0px;font-family:"微软雅黑";}
        #container{height:750px;width:100%;}
        #r-result{width:100%;}
    </style>    
</head>
<body>
    <div id="container"></div>
    <div id="r-result">
        <input type="button"  onclick="openHeatmap();" value="Show heatmap"/><input type="button"  onclick="closeHeatmap();" value="close Heatmap"/>
    </div>
</body>
</html>
<script type="text/javascript">
    var map = new BMap.Map("container");

    // var point = new BMap.Point(-8.629479, 41.156487);
    var point = new BMap.Point(-8.615547, 41.157642);
    map.centerAndZoom(point, 15);
    map.enableScrollWheelZoom();
  
    
    // function readTextFile(file, callback) {
    //     var rawFile = new XMLHttpRequest();
    //     rawFile.overrideMimeType("application/json");
    //     rawFile.open("GET", file, true);
    //     rawFile.onreadystatechange = function() {
    //         if (rawFile.readyState === 4 && rawFile.status == "200") {
    //             callback(rawFile.responseText);
    //         }
    //     }
    //     rawFile.send(null);
    // }

    // var results
    // readTextFile("F:/workSpaces/js/heapmap/dataset/locations.js", function(text){
    //     results = JSON.parse(text);
    // });

    var points =[
    {
        "count":1457,
        "lat":41.156595,
        "lng":-8.628903
    },
    {
        "count":6178,
        "lat":41.147514,
        "lng":-8.610678
    },
    {
        "count":483,
        "lat":41.15439,
        "lng":-8.649198
    },
    {
        "count":146,
        "lat":41.140899,
        "lng":-8.610021000000001
    },
    {
        "count":54,
        "lat":41.137496999999996,
        "lng":-8.614197
    },
    {
        "count":21,
        "lat":41.152770000000004,
        "lng":-8.6472
    },
    {
        "count":1122,
        "lat":41.14881,
        "lng":-8.585792999999999
    },
    {
        "count":821,
        "lat":41.14728,
        "lng":-8.621091
    },
    {
        "count":242,
        "lat":41.152599,
        "lng":-8.630244
    },
    {
        "count":225,
        "lat":41.183001000000004,
        "lng":-8.600382000000002
    },
    {
        "count":345,
        "lat":41.155515,
        "lng":-8.602587
    },
    {
        "count":316,
        "lat":41.160429,
        "lng":-8.609760000000001
    },
    {
        "count":181,
        "lat":41.129559,
        "lng":-8.620074
    },
    {
        "count":124,
        "lat":41.174469,
        "lng":-8.565561
    },
    {
        "count":198,
        "lat":41.140602,
        "lng":-8.635797
    },
    {
        "count":133,
        "lat":41.159115,
        "lng":-8.636202
    },
    {
        "count":123,
        "lat":41.152229999999996,
        "lng":-8.627436
    },
    {
        "count":813,
        "lat":41.141205,
        "lng":-8.614449
    },
    {
        "count":207,
        "lat":41.162841,
        "lng":-8.592272999999999
    },
    {
        "count":108,
        "lat":41.155695,
        "lng":-8.627517
    },
    {
        "count":32,
        "lat":41.18481,
        "lng":-8.603136
    },
    {
        "count":514,
        "lat":41.160708,
        "lng":-8.640882000000001
    },
    {
        "count":105,
        "lat":41.180787,
        "lng":-8.582751
    },
    {
        "count":123,
        "lat":41.153562,
        "lng":-8.607753
    },
    {
        "count":40,
        "lat":41.162796,
        "lng":-8.590518
    },
    {
        "count":30,
        "lat":41.156586,
        "lng":-8.679825
    },
    {
        "count":106,
        "lat":41.148963,
        "lng":-8.598987
    },
    {
        "count":83,
        "lat":41.143437,
        "lng":-8.621352
    },
    {
        "count":53,
        "lat":41.160996000000004,
        "lng":-8.607141
    },
    {
        "count":192,
        "lat":41.150538,
        "lng":-8.598645
    },
    {
        "count":20,
        "lat":41.182803,
        "lng":-8.598609
    },
    {
        "count":113,
        "lat":41.148801,
        "lng":-8.5842
    },
    {
        "count":63,
        "lat":41.17266,
        "lng":-8.611299
    },
    {
        "count":307,
        "lat":41.18094,
        "lng":-8.654256
    },
    {
        "count":75,
        "lat":41.162454,
        "lng":-8.644923
    },
    {
        "count":54,
        "lat":41.176323,
        "lng":-8.668809
    },
    {
        "count":129,
        "lat":41.152239,
        "lng":-8.606898
    },
    {
        "count":125,
        "lat":41.158322999999996,
        "lng":-8.604585
    },
    {
        "count":302,
        "lat":41.161221000000005,
        "lng":-8.604279
    },
    {
        "count":39,
        "lat":41.18175,
        "lng":-8.651196
    },
    {
        "count":46,
        "lat":41.144481,
        "lng":-8.624196000000001
    },
    {
        "count":45,
        "lat":41.181831,
        "lng":-8.601858
    },
    {
        "count":29,
        "lat":41.177735999999996,
        "lng":-8.598429
    },
    {
        "count":25,
        "lat":41.177565,
        "lng":-8.66349
    },
    {
        "count":37,
        "lat":41.175459000000004,
        "lng":-8.627706
    },
    {
        "count":181,
        "lat":41.153994,
        "lng":-8.604981
    },
    {
        "count":179,
        "lat":41.179608,
        "lng":-8.601966000000001
    },
    {
        "count":71,
        "lat":41.143113,
        "lng":-8.608383
    },
    {
        "count":30,
        "lat":41.1642,
        "lng":-8.622963
    },
    {
        "count":115,
        "lat":41.154363000000004,
        "lng":-8.613306
    },
    {
        "count":102,
        "lat":41.125563,
        "lng":-8.60535
    },
    {
        "count":18,
        "lat":41.1606,
        "lng":-8.584605
    },
    {
        "count":186,
        "lat":41.149656,
        "lng":-8.6049
    },
    {
        "count":48,
        "lat":41.16555,
        "lng":-8.606403
    },
    {
        "count":142,
        "lat":41.162337,
        "lng":-8.607969
    },
    {
        "count":22,
        "lat":41.170004999999996,
        "lng":-8.586702
    },
    {
        "count":23,
        "lat":41.162724,
        "lng":-8.627597999999999
    },
    {
        "count":273,
        "lat":41.159421,
        "lng":-8.638533
    },
    {
        "count":69,
        "lat":41.179518,
        "lng":-8.624412
    },
    {
        "count":112,
        "lat":41.182641,
        "lng":-8.604125999999999
    },
    {
        "count":22,
        "lat":41.147379,
        "lng":-8.587224
    },
    {
        "count":26,
        "lat":41.157954,
        "lng":-8.622441
    },
    {
        "count":63,
        "lat":41.180049,
        "lng":-8.604036
    },
    {
        "count":75,
        "lat":41.173524,
        "lng":-8.589780000000001
    },
    {
        "count":45,
        "lat":41.136957,
        "lng":-8.617032
    },
    {
        "count":25,
        "lat":41.134023,
        "lng":-8.614107
    },
    {
        "count":64,
        "lat":41.149998,
        "lng":-8.613036
    },
    {
        "count":75,
        "lat":41.160006,
        "lng":-8.659917
    },
    {
        "count":24,
        "lat":41.175351,
        "lng":-8.613764999999999
    },
    {
        "count":26,
        "lat":41.166909000000004,
        "lng":-8.626761
    },
    {
        "count":24,
        "lat":41.154588000000004,
        "lng":-8.618859
    },
    {
        "count":193,
        "lat":41.149916999999995,
        "lng":-8.620938
    },
    {
        "count":51,
        "lat":41.153364,
        "lng":-8.654607
    },
    {
        "count":32,
        "lat":41.158314000000004,
        "lng":-8.593407000000001
    },
    {
        "count":77,
        "lat":41.171067,
        "lng":-8.628615
    },
    {
        "count":102,
        "lat":41.164460999999996,
        "lng":-8.632206
    },
    {
        "count":22,
        "lat":41.154624,
        "lng":-8.593767
    },
    {
        "count":57,
        "lat":41.143023,
        "lng":-8.611488
    },
    {
        "count":46,
        "lat":41.166927,
        "lng":-8.594055
    },
    {
        "count":46,
        "lat":41.150358000000004,
        "lng":-8.611947
    },
    {
        "count":22,
        "lat":41.152149,
        "lng":-8.597088000000001
    },
    {
        "count":117,
        "lat":41.181822,
        "lng":-8.601246000000002
    },
    {
        "count":21,
        "lat":41.169411,
        "lng":-8.612703
    },
    {
        "count":28,
        "lat":41.15583,
        "lng":-8.663661
    },
    {
        "count":51,
        "lat":41.175117,
        "lng":-8.586198
    },
    {
        "count":59,
        "lat":41.160708,
        "lng":-8.611425
    },
    {
        "count":48,
        "lat":41.137263,
        "lng":-8.615385
    },
    {
        "count":17,
        "lat":41.169339,
        "lng":-8.625608999999999
    },
    {
        "count":35,
        "lat":41.158674,
        "lng":-8.633303999999999
    },
    {
        "count":74,
        "lat":41.162228999999996,
        "lng":-8.614125
    },
    {
        "count":67,
        "lat":41.157036,
        "lng":-8.612838
    },
    {
        "count":33,
        "lat":41.164074,
        "lng":-8.611002000000001
    },
    {
        "count":67,
        "lat":41.154272999999996,
        "lng":-8.673921
    },
    {
        "count":39,
        "lat":41.173515,
        "lng":-8.688339
    },
    {
        "count":146,
        "lat":41.161032,
        "lng":-8.629479
    },
    {
        "count":38,
        "lat":41.157,
        "lng":-8.666541
    },
    {
        "count":43,
        "lat":41.178168,
        "lng":-8.614025999999999
    },
    {
        "count":24,
        "lat":41.163291,
        "lng":-8.589402
    },
    {
        "count":109,
        "lat":41.15061,
        "lng":-8.62299
    },
    {
        "count":99,
        "lat":41.165541,
        "lng":-8.588780999999999
    },
    {
        "count":139,
        "lat":41.151321,
        "lng":-8.647524
    },
    {
        "count":26,
        "lat":41.142249,
        "lng":-8.617572000000001
    },
    {
        "count":63,
        "lat":41.151123,
        "lng":-8.614737
    },
    {
        "count":102,
        "lat":41.237181,
        "lng":-8.670096000000001
    },
    {
        "count":32,
        "lat":41.153822999999996,
        "lng":-8.596116
    },
    {
        "count":76,
        "lat":41.161149,
        "lng":-8.621046
    },
    {
        "count":77,
        "lat":41.151185999999996,
        "lng":-8.600346
    },
    {
        "count":55,
        "lat":41.162706,
        "lng":-8.610894
    },
    {
        "count":52,
        "lat":41.149809000000005,
        "lng":-8.619686999999999
    },
    {
        "count":32,
        "lat":41.158592999999996,
        "lng":-8.62443
    },
    {
        "count":28,
        "lat":41.165919,
        "lng":-8.624952
    },
    {
        "count":92,
        "lat":41.156451000000004,
        "lng":-8.620928999999999
    },
    {
        "count":46,
        "lat":41.153003999999996,
        "lng":-8.638155000000001
    },
    {
        "count":34,
        "lat":41.152212,
        "lng":-8.605989
    },
    {
        "count":126,
        "lat":41.149772999999996,
        "lng":-8.614251
    },
    {
        "count":48,
        "lat":41.187618,
        "lng":-8.597457
    },
    {
        "count":33,
        "lat":41.146992,
        "lng":-8.602209
    },
    {
        "count":126,
        "lat":41.157405,
        "lng":-8.601903
    },
    {
        "count":57,
        "lat":41.154255,
        "lng":-8.611974
    },
    {
        "count":44,
        "lat":41.164344,
        "lng":-8.620578
    },
    {
        "count":53,
        "lat":41.152671000000005,
        "lng":-8.636633999999999
    },
    {
        "count":49,
        "lat":41.165424,
        "lng":-8.598465
    },
    {
        "count":19,
        "lat":41.162696999999994,
        "lng":-8.638884
    },
    {
        "count":24,
        "lat":41.143266,
        "lng":-8.610327
    },
    {
        "count":65,
        "lat":41.137865999999995,
        "lng":-8.61255
    },
    {
        "count":34,
        "lat":41.179293,
        "lng":-8.598537
    },
    {
        "count":19,
        "lat":41.149413,
        "lng":-8.622873
    },
    {
        "count":22,
        "lat":41.167701,
        "lng":-8.595728999999999
    },
    {
        "count":24,
        "lat":41.154740999999994,
        "lng":-8.616294
    },
    {
        "count":90,
        "lat":41.148270000000004,
        "lng":-8.624592
    },
    {
        "count":44,
        "lat":41.158962,
        "lng":-8.644067999999999
    },
    {
        "count":46,
        "lat":41.161257,
        "lng":-8.628138
    },
    {
        "count":28,
        "lat":41.153652,
        "lng":-8.671086
    },
    {
        "count":31,
        "lat":41.162490000000005,
        "lng":-8.620911
    },
    {
        "count":136,
        "lat":41.163201,
        "lng":-8.584173
    },
    {
        "count":25,
        "lat":41.181624,
        "lng":-8.600463000000001
    },
    {
        "count":18,
        "lat":41.150259000000005,
        "lng":-8.6022
    },
    {
        "count":19,
        "lat":41.14962,
        "lng":-8.673705
    },
    {
        "count":20,
        "lat":41.154821999999996,
        "lng":-8.620938
    },
    {
        "count":121,
        "lat":41.142734999999995,
        "lng":-8.574741
    },
    {
        "count":81,
        "lat":41.133474,
        "lng":-8.612892
    },
    {
        "count":22,
        "lat":41.179149,
        "lng":-8.601138
    },
    {
        "count":17,
        "lat":41.168223,
        "lng":-8.689248
    },
    {
        "count":17,
        "lat":41.166647999999995,
        "lng":-8.625167999999999
    },
    {
        "count":40,
        "lat":41.176431,
        "lng":-8.58555
    },
    {
        "count":28,
        "lat":41.142753000000006,
        "lng":-8.614044
    },
    {
        "count":22,
        "lat":41.163021,
        "lng":-8.612667
    },
    {
        "count":88,
        "lat":41.164632,
        "lng":-8.583066
    },
    {
        "count":26,
        "lat":41.169852,
        "lng":-8.628651
    },
    {
        "count":25,
        "lat":41.148666,
        "lng":-8.648900999999999
    },
    {
        "count":60,
        "lat":41.167008,
        "lng":-8.649639
    },
    {
        "count":47,
        "lat":41.162256,
        "lng":-8.64981
    },
    {
        "count":25,
        "lat":41.181696,
        "lng":-8.663409
    },
    {
        "count":44,
        "lat":41.166918,
        "lng":-8.613197999999999
    },
    {
        "count":26,
        "lat":41.162463,
        "lng":-8.632916999999999
    },
    {
        "count":22,
        "lat":41.167287,
        "lng":-8.624169
    },
    {
        "count":21,
        "lat":41.147991,
        "lng":-8.605116
    },
    {
        "count":16,
        "lat":41.15655,
        "lng":-8.641656
    },
    {
        "count":21,
        "lat":41.143203,
        "lng":-8.617536
    },
    {
        "count":21,
        "lat":41.168754,
        "lng":-8.62758
    },
    {
        "count":16,
        "lat":41.163714,
        "lng":-8.664425999999999
    },
    {
        "count":22,
        "lat":41.143329,
        "lng":-8.637939
    },
    {
        "count":32,
        "lat":41.17437,
        "lng":-8.648703
    },
    {
        "count":39,
        "lat":41.14638,
        "lng":-8.630595
    },
    {
        "count":28,
        "lat":41.1498,
        "lng":-8.675928
    },
    {
        "count":28,
        "lat":41.141682,
        "lng":-8.61642
    },
    {
        "count":38,
        "lat":41.159475,
        "lng":-8.611848
    },
    {
        "count":18,
        "lat":41.169618,
        "lng":-8.58942
    },
    {
        "count":83,
        "lat":41.152004999999996,
        "lng":-8.617833000000001
    },
    {
        "count":24,
        "lat":41.15808,
        "lng":-8.624979
    },
    {
        "count":37,
        "lat":41.157837,
        "lng":-8.623602
    },
    {
        "count":58,
        "lat":41.144228999999996,
        "lng":-8.641125
    },
    {
        "count":23,
        "lat":41.146677000000004,
        "lng":-8.596206
    },
    {
        "count":17,
        "lat":41.162166,
        "lng":-8.648325
    },
    {
        "count":34,
        "lat":41.154345,
        "lng":-8.645904
    },
    {
        "count":72,
        "lat":41.170977,
        "lng":-8.58843
    },
    {
        "count":41,
        "lat":41.159106,
        "lng":-8.683434
    },
    {
        "count":31,
        "lat":41.15745,
        "lng":-8.652222
    },
    {
        "count":17,
        "lat":41.13747,
        "lng":-8.596404
    },
    {
        "count":33,
        "lat":41.159133000000004,
        "lng":-8.59779
    },
    {
        "count":38,
        "lat":41.153985,
        "lng":-8.620983
    },
    {
        "count":29,
        "lat":41.172723,
        "lng":-8.612793
    },
    {
        "count":14,
        "lat":41.155209,
        "lng":-8.618796000000001
    },
    {
        "count":21,
        "lat":41.158773,
        "lng":-8.59887
    },
    {
        "count":30,
        "lat":41.138172,
        "lng":-8.611308
    },
    {
        "count":20,
        "lat":41.157189,
        "lng":-8.589258000000001
    },
    {
        "count":51,
        "lat":41.149053,
        "lng":-8.625735
    },
    {
        "count":26,
        "lat":41.136866999999995,
        "lng":-8.618003999999999
    },
    {
        "count":52,
        "lat":41.123799,
        "lng":-8.614728
    },
    {
        "count":27,
        "lat":41.169798,
        "lng":-8.608167
    },
    {
        "count":27,
        "lat":41.164164,
        "lng":-8.618355000000001
    },
    {
        "count":17,
        "lat":41.161518,
        "lng":-8.615691
    },
    {
        "count":32,
        "lat":41.152482,
        "lng":-8.649
    },
    {
        "count":21,
        "lat":41.154525,
        "lng":-8.653536
    },
    {
        "count":29,
        "lat":41.152626,
        "lng":-8.633322
    },
    {
        "count":25,
        "lat":41.151213,
        "lng":-8.628651
    },
    {
        "count":32,
        "lat":41.164317,
        "lng":-8.600931
    },
    {
        "count":22,
        "lat":41.164506,
        "lng":-8.645489999999999
    },
    {
        "count":39,
        "lat":41.151140999999996,
        "lng":-8.625897
    },
    {
        "count":24,
        "lat":41.160042,
        "lng":-8.607969
    },
    {
        "count":19,
        "lat":41.150960999999995,
        "lng":-8.604261
    },
    {
        "count":20,
        "lat":41.164038,
        "lng":-8.662626
    },
    {
        "count":20,
        "lat":41.1615,
        "lng":-8.632116
    },
    {
        "count":23,
        "lat":41.165964,
        "lng":-8.620353
    },
    {
        "count":26,
        "lat":41.181579,
        "lng":-8.658081
    },
    {
        "count":23,
        "lat":41.158845,
        "lng":-8.627103
    },
    {
        "count":26,
        "lat":41.161635,
        "lng":-8.610426
    },
    {
        "count":40,
        "lat":41.145965999999994,
        "lng":-8.596458
    },
    {
        "count":21,
        "lat":41.139063,
        "lng":-8.609346
    },
    {
        "count":17,
        "lat":41.166098999999996,
        "lng":-8.647857
    },
    {
        "count":24,
        "lat":41.153337,
        "lng":-8.599662
    },
    {
        "count":23,
        "lat":41.148270000000004,
        "lng":-8.658846
    },
    {
        "count":23,
        "lat":41.160357,
        "lng":-8.644185
    },
    {
        "count":22,
        "lat":41.154813,
        "lng":-8.62686
    },
    {
        "count":13,
        "lat":41.152545,
        "lng":-8.607654
    },
    {
        "count":16,
        "lat":41.153175,
        "lng":-8.656461
    },
    {
        "count":18,
        "lat":41.156946000000005,
        "lng":-8.630927999999999
    },
    {
        "count":28,
        "lat":41.154759000000006,
        "lng":-8.595423
    },
    {
        "count":17,
        "lat":41.150808000000005,
        "lng":-8.593263
    },
    {
        "count":21,
        "lat":41.162796,
        "lng":-8.611902
    },
    {
        "count":28,
        "lat":41.162058,
        "lng":-8.605332
    },
    {
        "count":23,
        "lat":41.152392,
        "lng":-8.677475999999999
    },
    {
        "count":21,
        "lat":41.163768,
        "lng":-8.60175
    },
    {
        "count":16,
        "lat":41.166819,
        "lng":-8.594937
    },
    {
        "count":16,
        "lat":41.149097999999995,
        "lng":-8.629083
    },
    {
        "count":14,
        "lat":41.146821,
        "lng":-8.613648
    },
    {
        "count":19,
        "lat":41.157612,
        "lng":-8.593902
    },
    {
        "count":20,
        "lat":41.158305,
        "lng":-8.609967
    },
    {
        "count":18,
        "lat":41.149962,
        "lng":-8.586063000000001
    },
    {
        "count":21,
        "lat":41.16357,
        "lng":-8.647191000000001
    },
    {
        "count":36,
        "lat":41.161617,
        "lng":-8.611299
    },
    {
        "count":25,
        "lat":41.161338,
        "lng":-8.600418
    },
    {
        "count":16,
        "lat":41.151168,
        "lng":-8.619309
    },
    {
        "count":18,
        "lat":41.183649,
        "lng":-8.602947
    },
    {
        "count":17,
        "lat":41.173704,
        "lng":-8.603586
    },
    {
        "count":11,
        "lat":41.138424,
        "lng":-8.610686999999999
    },
    {
        "count":15,
        "lat":41.140332,
        "lng":-8.614539
    },
    {
        "count":15,
        "lat":41.162048999999996,
        "lng":-8.638056
    },
    {
        "count":21,
        "lat":41.118722999999996,
        "lng":-8.622314999999999
    },
    {
        "count":17,
        "lat":41.166882,
        "lng":-8.626068
    },
    {
        "count":12,
        "lat":41.156667,
        "lng":-8.631432
    },
    {
        "count":18,
        "lat":41.155559999999994,
        "lng":-8.595207
    },
    {
        "count":15,
        "lat":41.152662,
        "lng":-8.616087
    },
    {
        "count":15,
        "lat":41.158512,
        "lng":-8.639514
    },
    {
        "count":17,
        "lat":41.169726000000004,
        "lng":-8.626994999999999
    },
    {
        "count":15,
        "lat":41.159007,
        "lng":-8.601246000000002
    },
    {
        "count":16,
        "lat":41.173515,
        "lng":-8.685027
    },
    {
        "count":11,
        "lat":41.166576,
        "lng":-8.620289999999999
    },
    {
        "count":12,
        "lat":41.147388,
        "lng":-8.601777
    },
    {
        "count":15,
        "lat":41.159403000000005,
        "lng":-8.665892999999999
    }
    ];
   
    if(!isSupportCanvas()){
        alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~')
    }
    //详细的参数,可以查看heatmap.js的文档 https://github.com/pa7/heatmap.js/blob/master/README.md
    //参数说明如下:
    /* visible 热力图是否显示,默认为true
     * opacity 热力的透明度,1-100
     * radius 势力图的每个点的半径大小   
     * gradient  {JSON} 热力图的渐变区间 . gradient如下所示
     *  {
            .2:'rgb(0, 255, 255)',
            .5:'rgb(0, 110, 255)',
            .8:'rgb(100, 0, 255)'
        }
        其中 key 表示插值的位置, 0~1. 
            value 为颜色值. 
     */
    heatmapOverlay = new BMapLib.HeatmapOverlay({"radius":40});
    map.addOverlay(heatmapOverlay);
    heatmapOverlay.setDataSet({data:points,max:120});
    
    var icon = new BMap.Icon(
      './image/position-4.png',
      new BMap.Size(32, 32)
    );
    // var mostDensityPoint = new BMap.Point(-8.607786,41.153133);
    // var mostDensityPoint = new BMap.Point(-8.60757,41.152916);
    var markerList =  [
        // {"text": 'Fernando Santos, Lda', "location": [-8.607642, 41.153513] },
        // {"text": 'SAO BENTO TARIN STATION', "location": [-8.610624,41.146805]},
        // {"text": 'Churrasqueira Domingos', "location": [-8.621332,41.151476]},
        // {"text": 'Wines Museum', "location": [-8.625716,41.144958]},
        // {"text": 'Valor Mais', "location": [-8.625788,41.166739]},
        {"text": '(1)', "location": [-8.610624,41.146805]},
        {"text": '(2)', "location": [-8.605881,41.153731]},
        // {"text": '(2)', "location": [-8.621332,41.151476]},
        // {"text": '(3)', "location": [-8.625716,41.144958]},
        {"text": '(3)', "location": [-8.625788,41.166739]},
        {"text": '(4)', "location": [-8.59661,41.154329]},
    ];
    for (var i = 0; i < markerList.length; i++) {
        mk = markerList[i];
        var mostDensityPoint = new BMap.Point(mk['location'][0],mk['location'][1]);
        var marker = new BMap.Marker(mostDensityPoint, {icon: icon});
        const label = new BMap.Label(
          mk['text'],
          { offset: new BMap.Size(30, 10 ) }
        )
        label.setStyle({
            color : "#000000",
            fontSize : "16px",
            border: "none",
            fontWeight: "bold",
            height : "20px",
            backgroundColor: 'rgb(' + 255 + ',' + 255 + ',' + 255 + ',' + 0.1 + ')',
            lineHeight : "20px",
            fontFamily:"微软雅黑"
        });
        marker.setLabel(label);
        map.addOverlay(marker);
    }

    function openHeatmap(){
        heatmapOverlay.show();
    }
    function closeHeatmap(){
        heatmapOverlay.hide();
    }
    closeHeatmap();
    function setGradient(){
        /*:
        {
            0:'rgb(102, 255, 0)',
            .5:'rgb(255, 170, 0)',
            1:'rgb(255, 0, 0)'
        }*/
        var gradient = {};
        var colors = document.querySelectorAll("input[type='color']");
        colors = [].slice.call(colors,0);
        colors.forEach(function(ele){
            gradient[ele.getAttribute("data-key")] = ele.value; 
        });
        heatmapOverlay.setOptions({"gradient":gradient});
    }
    function isSupportCanvas(){
        var elem = document.createElement('canvas');
        return !!(elem.getContext && elem.getContext('2d'));
    }
</script>